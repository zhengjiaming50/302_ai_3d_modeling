# 模型本地存储功能说明

## 功能概述

本项目新增了对3D模型的本地存储功能，所有生成的3D模型不仅会上传到远程服务器，还会自动保存到项目的本地存储目录中，确保即使远程服务器上的文件过期或被删除，模型文件也能永久保存。

## 目录结构

- `/public` - 主存储目录（公共访问目录）
  - `/public/models` - 3D模型文件存储目录
  - `/public/images` - 图片文件存储目录

## 数据库字段

模型表中新增了`local_file_path`字段，用于记录模型文件在本地的存储路径。这允许系统即使在远程URL失效后仍能找到并显示模型文件。

## 如何使用

1. **初始化数据库和存储目录**:
   ```bash
   npm run init-db
   ```
   这会创建必要的数据库表和存储目录。

2. **生成模型**:
   当您生成一个新的3D模型时，系统会自动:
   - 将模型上传到远程服务器
   - 保存模型到本地`public/models`目录
   - 在数据库中记录模型信息，包括本地文件路径

3. **查看本地存储的模型**:
   所有模型文件均以`model-[时间戳].glb`的格式保存在`public/models`目录下。
   图片文件保存在`public/images`目录下。

## 技术实现

- 文件保存逻辑位于`src/lib/file-storage.ts`
- 每个模型生成后通过API将文件保存到本地
- 支持从URL和Blob两种方式保存文件

## 注意事项

- 使用`public`目录作为存储位置，确保文件可以通过Web直接访问
- 存储在`public`目录的文件将直接对外可访问，请勿存储敏感数据
- 大量的模型文件可能会占用较多磁盘空间，定期清理可能是必要的
- 数据库中记录的文件路径是相对于项目根目录的，如果移动项目可能需要更新路径 